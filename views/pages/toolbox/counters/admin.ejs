<!doctype html>
<html lang="en">
	<head>
		<%- include('../../../partials/head'); %>
	</head>
	<body>
		<header>
			<%- include('../../../partials/header'); %>
		</header>

		<main>
			<div>hello! this is the admin page for a counter</div>
			<% if (message) { %>
			<%= message; %>
			<% } %>

			<p>total increments: <%= counter.increments; %></p>
			<p>unique increments: <%= counter._count.views; %></p>

			<% const action = counter.deleted ? "restore" : "archive"; %>
			<form
				method="post"
				class="<%= action; %>"
				action="/toolbox/counters/admin/<%= counter.id; %>/<%= action; %>"
			>
				<button class="<%= action; %>-save"><%= action; %></button>
			</form>

			<form method="post" class="edit-form" action="/toolbox/counters/admin/<%= counter.id; %>/edit">
				<label for="name" class="name-label">name</label>
				<input
					class="name-input"
					id="name"
					name="name"
					value="<%= counter.name; %>"
					required
					maxlength="<%= Config.DEFAULT_MAX_LENGTH; %>"
				/>

				<label for="origin" class="origin-label">origin</label>
				<input
					class="origin-input"
					id="origin"
					name="origin"
					value="<%= counter.origin; %>"
					maxlength="<%= Config.DEFAULT_MAX_LENGTH; %>"
				/>
				<label for="unique" class="unique-label">unique</label>
				<% if (counter.unique) { %>
				<input class="unique-input" id="unique" type="checkbox" name="unique" title="unique" checked />
				<% } else { %>
				<input class="unique-input" id="unique" type="checkbox" name="unique" title="unique" />
				<% } %>

				<label for="increment-amount" class="increment-amount-label">increment amount</label>
				<input
					class="increment-amount"
					id="increment-amount"
					name="increment-amount"
					value="<%= counter.incrementAmount; %>"
					type="number"
				/>

				<% for (const {camel, skewer, name} of [
                    {camel: 'allowApiInc', skewer: "allow-api-inc", name: 'allow api increment'},
                    {camel: 'allowApiSet', skewer: "allow-api-set", name: 'allow api set'},
                    {camel: 'allowApiGet', skewer: "allow-api-get", name: 'allow api get'}
                ]) {%>
				<label for="<%=skewer%>" class="<%=skewer%>-label"><%=name%></label>
				<% if (counter[camel]) { %>
				<input
					class="<%=skewer%>-input"
					id="<%=skewer%>"
					type="checkbox"
					name="<%=skewer%>"
					title="<%=skewer%>"
					checked
				/>
				<% } else { %>
				<input
					class="<%=skewer%>-input"
					id="<%=skewer%>"
					type="checkbox"
					name="<%=skewer%>"
					title="<%=skewer%>"
				/>
				<% } %>
				<% } %>

				<label for="current-value-input" class="current-value-label">current amount</label>
				<input
					class="current-value"
					id="current-value-input"
					name="current-value"
					value="<%= counter.value; %>"
					type="number"
				/>

				<button class="edit-save">submit</button>
			</form>
			<hr />
			images:
			<a href="/toolbox/counters/<%=counter.id%>/png/create">create a new counter image</a>
			<%- include('../../../partials/counters/counter-images-table'); %>
		</main>
	</body>
</html>
